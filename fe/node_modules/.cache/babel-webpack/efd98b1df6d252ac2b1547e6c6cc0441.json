{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/rotem.levi/Downloads/CakesShoppingOnline_/CakesShoppingOnline_/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as d3 from 'd3';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class PieComponent {\n  constructor(http) {\n    this.http = http;\n    this.margin = 50;\n    this.width = 750;\n    this.height = 600; // The radius of the pie chart is half the smallest side\n\n    this.radius = Math.min(this.width, this.height) / 2 - this.margin;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        _this.data = yield _this.http.get(environment.categoriesUrl + \"products/agg\").toPromise();\n      } catch (err) {\n        alert(err.message);\n      } // this.data = await this.http.get<any[]>(environment.categoriesUrl + \"products/agg-supllier\").toPromise();\n\n\n      console.log(\"this is data from pie component\");\n      console.log(_this.data);\n\n      _this.createSvg();\n\n      _this.createColors();\n\n      _this.drawChart();\n    })();\n  }\n\n  createSvg() {\n    this.svg = d3.select(\"figure#pie\").append(\"svg\").attr(\"width\", this.width).attr(\"height\", this.height).append(\"g\").attr(\"transform\", \"translate(\" + this.width / 2 + \",\" + this.height / 2 + \")\");\n  }\n\n  createColors() {\n    this.colors = d3.scaleOrdinal().domain(this.data.map(d => d.count.toString())).range([\"#c7d3ec\", \"#a5b8db\", \"#a5b8bb\", \"#879cc4\", \"#677795\", \"#5a6782\", \"#5a6882\"]);\n  }\n\n  drawChart() {\n    // Compute the position of each group on the pie:\n    const pie = d3.pie().value(d => Number(d.count)); // Build the pie chart\n\n    this.svg.selectAll('pieces').data(pie(this.data)).enter().append('path').attr('d', d3.arc().innerRadius(0).outerRadius(this.radius)).attr('fill', (d, i) => this.colors(i)).attr(\"stroke\", \"#121926\").style(\"stroke-width\", \"1px\"); // Add labels\n\n    const labelLocation = d3.arc().innerRadius(100).outerRadius(this.radius);\n    this.svg.selectAll('pieces').data(pie(this.data)).enter().append('text').text(d => d.data.name).attr(\"transform\", d => \"translate(\" + labelLocation.centroid(d) + \")\").style(\"text-anchor\", \"middle\").style(\"font-size\", 15);\n  }\n\n}\n\nPieComponent.ɵfac = function PieComponent_Factory(t) {\n  return new (t || PieComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n};\n\nPieComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PieComponent,\n  selectors: [[\"app-pie\"]],\n  decls: 6,\n  vars: 0,\n  consts: [[\"id\", \"pie\"]],\n  template: function PieComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\");\n      i0.ɵɵelementStart(1, \"h2\");\n      i0.ɵɵtext(2, \"Category share (by products num)\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"h5\");\n      i0.ɵɵtext(4, \"D3.js Bar Chart - Data brought by Group By mondoDb Query\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(5, \"figure\", 0);\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"div[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBpZS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0kscUJBQXFCOztBQUV6QiIsImZpbGUiOiJwaWUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImRpdiB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcblxyXG59Il19 */\"]\n});","map":{"version":3,"sources":["C:/Users/rotem.levi/Downloads/CakesShoppingOnline_/CakesShoppingOnline_/fe/src/app/components/admin-area/graphs/pie/pie.component.ts"],"names":["d3","environment","i0","i1","PieComponent","constructor","http","margin","width","height","radius","Math","min","ngOnInit","data","get","categoriesUrl","toPromise","err","alert","message","console","log","createSvg","createColors","drawChart","svg","select","append","attr","colors","scaleOrdinal","domain","map","d","count","toString","range","pie","value","Number","selectAll","enter","arc","innerRadius","outerRadius","i","style","labelLocation","text","name","centroid","ɵfac","PieComponent_Factory","t","ɵɵdirectiveInject","HttpClient","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","PieComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","styles"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\r\nimport { environment } from 'src/environments/environment';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nexport class PieComponent {\r\n    constructor(http) {\r\n        this.http = http;\r\n        this.margin = 50;\r\n        this.width = 750;\r\n        this.height = 600;\r\n        // The radius of the pie chart is half the smallest side\r\n        this.radius = Math.min(this.width, this.height) / 2 - this.margin;\r\n    }\r\n    async ngOnInit() {\r\n        try {\r\n            this.data = await this.http.get(environment.categoriesUrl + \"products/agg\").toPromise();\r\n        }\r\n        catch (err) {\r\n            alert(err.message);\r\n        }\r\n        // this.data = await this.http.get<any[]>(environment.categoriesUrl + \"products/agg-supllier\").toPromise();\r\n        console.log(\"this is data from pie component\");\r\n        console.log(this.data);\r\n        this.createSvg();\r\n        this.createColors();\r\n        this.drawChart();\r\n    }\r\n    createSvg() {\r\n        this.svg = d3.select(\"figure#pie\")\r\n            .append(\"svg\")\r\n            .attr(\"width\", this.width)\r\n            .attr(\"height\", this.height)\r\n            .append(\"g\")\r\n            .attr(\"transform\", \"translate(\" + this.width / 2 + \",\" + this.height / 2 + \")\");\r\n    }\r\n    createColors() {\r\n        this.colors = d3.scaleOrdinal()\r\n            .domain(this.data.map(d => d.count.toString()))\r\n            .range([\"#c7d3ec\", \"#a5b8db\", \"#a5b8bb\", \"#879cc4\", \"#677795\", \"#5a6782\", \"#5a6882\"]);\r\n    }\r\n    drawChart() {\r\n        // Compute the position of each group on the pie:\r\n        const pie = d3.pie().value((d) => Number(d.count));\r\n        // Build the pie chart\r\n        this.svg\r\n            .selectAll('pieces')\r\n            .data(pie(this.data))\r\n            .enter()\r\n            .append('path')\r\n            .attr('d', d3.arc()\r\n            .innerRadius(0)\r\n            .outerRadius(this.radius))\r\n            .attr('fill', (d, i) => (this.colors(i)))\r\n            .attr(\"stroke\", \"#121926\")\r\n            .style(\"stroke-width\", \"1px\");\r\n        // Add labels\r\n        const labelLocation = d3.arc()\r\n            .innerRadius(100)\r\n            .outerRadius(this.radius);\r\n        this.svg\r\n            .selectAll('pieces')\r\n            .data(pie(this.data))\r\n            .enter()\r\n            .append('text')\r\n            .text((d) => d.data.name)\r\n            .attr(\"transform\", (d) => \"translate(\" + labelLocation.centroid(d) + \")\")\r\n            .style(\"text-anchor\", \"middle\")\r\n            .style(\"font-size\", 15);\r\n    }\r\n}\r\nPieComponent.ɵfac = function PieComponent_Factory(t) { return new (t || PieComponent)(i0.ɵɵdirectiveInject(i1.HttpClient)); };\r\nPieComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PieComponent, selectors: [[\"app-pie\"]], decls: 6, vars: 0, consts: [[\"id\", \"pie\"]], template: function PieComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\");\r\n        i0.ɵɵelementStart(1, \"h2\");\r\n        i0.ɵɵtext(2, \"Category share (by products num)\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(3, \"h5\");\r\n        i0.ɵɵtext(4, \"D3.js Bar Chart - Data brought by Group By mondoDb Query\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(5, \"figure\", 0);\r\n        i0.ɵɵelementEnd();\r\n    } }, styles: [\"div[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBpZS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0kscUJBQXFCOztBQUV6QiIsImZpbGUiOiJwaWUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImRpdiB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcblxyXG59Il19 */\"] });\r\n"]},"metadata":{},"sourceType":"module"}